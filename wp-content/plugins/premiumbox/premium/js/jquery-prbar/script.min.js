jQuery(function(y){var k={trigger:"",start_title:"we determine the number of requests...",end_title:"number of requests defined",found_title:"Found: %count% requests",perform_title:"Perform:",step_title:"Step:",run_title:"Run",line_text:"start step %now% of %max% step",end_progress:"action is completed",line_success:"step %now% is success",success:function(){}};y.fn.PrBar=function(r){var e=y.extend({},k,e,r),t=(y(this),e.trigger),a=e.start_title,s=e.end_title,i=(i=e.found_title).replace("%count%",'<input type="text" name="" class="prbar_num_count" value="0" />'),n=e.perform_title,p=e.step_title,c=e.run_title,o=e.line_text,_=e.end_progress,l=e.line_success,d=e.success,u="",v="",b="",m=0,w=0,f=0,h="";function x(r,e){var t=new Date,a=t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();y(".prbar_log").after('<div class="prbar_line '+e+'">['+a+"] "+r+"</div>")}function g(e){var r;e<=f?(x(o.replace("%now%",e).replace("%max%",f).replace("%text%",b),""),r="limit="+w+"&num_page="+e,y.ajax({type:"POST",url:v,dataType:"json",data:r,error:function(r,e,t){for(key in y(".prbar_wrap").removeClass("deactive"),x("error:"+e,"color_red"),r)console.log(key+" = "+r[key])},success:function(r){"error"==r.status&&x(r.status_text,"color_red"),"success"==r.status&&x(l.replace("%now%",e).replace("%text%",r.status_text),"color_green"),function(r){var e=f/100,t=Math.ceil(r/e);y(".prbar_ind").show(),y(".prbar_ind_text").html(t+"%");var a=Math.ceil(t*y(".prbar_ind").width()/100);y(".prbar_ind_abs").css({width:a+"px"})}(e),g(e+=1)}})):(y(".prbar_wrap").removeClass("deactive"),x(_,"color_green"),d.apply(null,[h]))}return y(document).on("click",t,function(){var r;r='<div class="prbar_shadow js_techwindow"></div><div class="prbar_wrap js_techwindow"><div class="prbar_wrap_ins"><div class="prbar_close"></div><div class="prbar_title"></div><div class="prbar_content"><div class="prbar_num">'+i+'</div><div class="prbar_control"><div class="prbar_input">'+n+' <input type="text" name="" class="prbar_count" value="50" /></div><div class="prbar_input">'+p+' <input type="text" name="" class="prbar_step_num" value="1" /></div><div class="prbar_submit">'+c+'</div><div class="premium_clear"></div></div><div class="prbar_ind"><div class="prbar_ind_abs"></div><div class="prbar_ind_text"></div></div><div class="prbar_log_wrap"><div class="prbar_log"></div></div></div></div></div>',y("body").append(r),h=y(this);var e=y.trim(y(this).attr("data-title"));return y(".prbar_title").html(e),y(".prbar_shadow, .prbar_wrap").show(),y(".prbar_log_wrap .prbar_line").remove(),y(".prbar_ind").hide(),y(".prbar_ind_text").html("0%"),y(".prbar_ind_abs").css({width:"0px"}),y(".prbar_num_count").val("0"),y(".prbar_control, .prbar_num").hide(),y(".prbar_wrap").addClass("deactive"),(u=y.trim(y(this).attr("data-count-url")))?(x(a,""),y.ajax({type:"POST",url:u,dataType:"json",data:"action=progressbar",error:function(r,e,t){for(key in y(".prbar_wrap").removeClass("deactive"),x("error:"+e,"color_red"),r)console.log(key+" = "+r[key])},success:function(r){y(".prbar_wrap").removeClass("deactive"),"error"==r.status&&x(r.status_text,"color_red"),"success"==r.status&&(x(s,"color_green"),m=parseInt(r.count),b=r.status_text,y(".prbar_num_count").val(m),y(".prbar_num, .prbar_control").show(),v=r.link,y(".prbar_step_num").val("1"))}})):(y(".prbar_wrap").removeClass("deactive"),x("error data-count-url","color_red")),!1}),y(document).on("click",".prbar_wrap:not(.deactive) .prbar_submit",function(){y(".prbar_wrap").addClass("deactive"),(w=parseInt(y(".prbar_count").val()))<1&&(w=1),(m=parseInt(y.trim(y(".prbar_num_count").val())))<1&&(m=1),f=Math.ceil(m/w);var r=parseInt(y(".prbar_step_num").val());return r<1&&(r=1),g(r),!1}),y(document).on("click",".prbar_wrap:not(.deactive) .prbar_close",function(){return y(".prbar_shadow, .prbar_wrap").remove(),!1}),this}});